# Pattern di Estensione Filament nel Framework Xot

## Regola Fondamentale: "Mai Estendere Filament Direttamente"

Tutte le classi Filament DEVONO essere estese esclusivamente attraverso le classi base `XotBase*` fornite dal modulo Xot. L'estensione diretta delle classi native di Filament è severamente proibita.

## Mapping delle Classi Base XotBase per Filament

| Classe Filament | Classe XotBase | Namespace Corretto |
|----------------|----------------|-------------------|
| `\Filament\Resources\Resource` | `XotBaseResource` | `Modules\Xot\Filament\Resources` |
| `\Filament\Resources\Pages\Page` | `XotBasePage` | `Modules\Xot\Filament\Resources\Pages` |
| `\Filament\Resources\Pages\ListRecords` | `XotBaseListRecords` | `Modules\Xot\Filament\Resources\Pages` |
| `\Filament\Resources\Pages\CreateRecord` | `XotBaseCreateRecord` | `Modules\Xot\Filament\Resources\Pages` |
| `\Filament\Resources\Pages\EditRecord` | `XotBaseEditRecord` | `Modules\Xot\Filament\Resources\Pages` |
| `\Filament\Pages\Page` | `XotBasePage` | `Modules\Xot\Filament\Pages` |
| `\Filament\Widgets\Widget` | `XotBaseWidget` | `Modules\Xot\Filament\Widgets` |

## Struttura delle Classi Filament nei Moduli

```
Modules/
  ModuleName/
    app/
      Filament/                      # Radice dei componenti Filament
        Pages/                       # Pagine Filament
          Dashboard.php             # Estende XotBasePage
        Resources/                   # Risorse Filament
          ModelResource.php         # Estende XotBaseResource
          ModelResource/            # Pagine specifiche della risorsa
            Pages/
              ListModels.php       # Estende XotBaseListRecords
              CreateModel.php      # Estende XotBaseCreateRecord
              EditModel.php        # Estende XotBaseEditRecord
        Widgets/                     # Widget Filament
          StatsWidget.php           # Estende XotBaseWidget
```

## Convenzioni di Implementazione

### 1. Schema dei Form

I metodi che definiscono schemi di form DEVONO restituire array associativi con chiavi di stringa:

```php
// CORRETTO ✅
public static function getFormSchema(): array
{
    return [
        'title' => Forms\Components\TextInput::make('title')
            ->required(),
        'content' => Forms\Components\RichEditor::make('content')
            ->columnSpan(2),
    ];
}

// ERRATO ❌
public static function getFormSchema(): array
{
    return [
        Forms\Components\TextInput::make('title')
            ->required(),
        Forms\Components\RichEditor::make('content')
            ->columnSpan(2),
    ];
}
```

### 2. Metodi di Tabella

I seguenti metodi DEVONO restituire array associativi con chiavi di stringa:
- `getTableColumns()`
- `getTableFilters()`
- `getTableActions()`
- `getTableBulkActions()`

### 3. Metodo `getPages()`

Se `getPages()` restituisce solo le route standard (index, create, edit, view), il metodo DEVE essere rimosso:

```php
// OMETTERE COMPLETAMENTE SE CONTIENE SOLO QUESTE ROUTE STANDARD
public static function getPages(): array
{
    return [
        'index' => Pages\ListRecords::route('/'),
        'create' => Pages\CreateRecord::route('/create'),
        'edit' => Pages\EditRecord::route('/{record}/edit'),
        'view' => Pages\ViewRecord::route('/{record}'),
    ];
}
```

### 4. Metodo `getRelations()`

Se `getRelations()` restituisce un array vuoto, il metodo DEVE essere rimosso:

```php
// OMETTERE COMPLETAMENTE SE VUOTO
public static function getRelations(): array
{
    return [];
}
```

### 5. Proprietà `$navigationIcon`

Non definire `$navigationIcon` se la classe estende `XotBaseResource`:

```php
// OMETTERE COMPLETAMENTE
protected static ?string $navigationIcon = 'heroicon-o-document';
```

## Gestione delle Traduzioni

### Mai Utilizzare `->label()`

Non utilizzare mai il metodo `->label()` nei componenti Filament. Le etichette sono gestite automaticamente dal `LangServiceProvider`:

```php
// CORRETTO ✅
Forms\Components\TextInput::make('title')

// ERRATO ❌
Forms\Components\TextInput::make('title')
    ->label('Titolo')
```

### Strutura dei File di Traduzione

Le traduzioni devono seguire questa struttura nei file di lingua:

```php
// lang/it/resource.php
return [
    'fields' => [
        'title' => [
            'label' => 'Titolo',
            'help' => 'Inserisci il titolo del documento',
        ],
        'content' => [
            'label' => 'Contenuto',
        ],
    ],
];
```

## Errori Comuni e Soluzioni

1. **Estensione Diretta delle Classi Filament**: Sempre estendere la classe XotBase corrispondente
2. **Namespace Errato**: Usare `Modules\ModuleName\Filament`, non `Modules\ModuleName\App\Filament`
3. **Array Non Associativi**: Convertire tutti gli array di form e tabelle in array associativi
4. **Uso di ->label()**: Rimuovere e utilizzare i file di traduzione
5. **Metodi Ridondanti**: Rimuovere metodi `getPages()`, `getRelations()` se standard/vuoti
