#!/bin/bash

# Script per correggere tutte le traduzioni inglesi che contengono testo italiano
# Regola: tutti i file in lang/en/ devono essere effettivamente in inglese

set -e

echo "üîç Iniziando correzione completa traduzioni inglesi..."
echo "üìã Regola: tutti i file in lang/en/ devono essere in inglese"
echo ""

# Contatore per le correzioni
files_fixed=0

# Funzione per correggere un file specifico
fix_file() {
    local file="$1"
    local temp_file="${file}.tmp"
    
    echo "üìÑ Correggendo: $file"
    
    # Backup del file originale
    cp "$file" "${file}.backup"
    
    # Applica le correzioni comuni
    sed -i 's/Gennaio/January/g' "$file"
    sed -i 's/Febbraio/February/g' "$file"
    sed -i 's/Marzo/March/g' "$file"
    sed -i 's/Aprile/April/g' "$file"
    sed -i 's/Maggio/May/g' "$file"
    sed -i 's/Giugno/June/g' "$file"
    sed -i 's/Luglio/July/g' "$file"
    sed -i 's/Agosto/August/g' "$file"
    sed -i 's/Settembre/September/g' "$file"
    sed -i 's/Ottobre/October/g' "$file"
    sed -i 's/Novembre/November/g' "$file"
    sed -i 's/Dicembre/December/g' "$file"
    
    # Giorni della settimana
    sed -i 's/Luned√¨/Monday/g' "$file"
    sed -i 's/Marted√¨/Tuesday/g' "$file"
    sed -i 's/Mercoled√¨/Wednesday/g' "$file"
    sed -i 's/Gioved√¨/Thursday/g' "$file"
    sed -i 's/Venerd√¨/Friday/g' "$file"
    sed -i 's/Sabato/Saturday/g' "$file"
    sed -i 's/Domenica/Sunday/g' "$file"
    
    # Termini comuni
    sed -i 's/Configurazione/Configuration/g' "$file"
    sed -i 's/Orari/Hours/g' "$file"
    sed -i 's/Mattina/Morning/g' "$file"
    sed -i 's/Pomeriggio/Afternoon/g' "$file"
    sed -i 's/Aperto/Open/g' "$file"
    sed -i 's/Chiuso/Closed/g' "$file"
    sed -i 's/Nome/Name/g' "$file"
    sed -i 's/Cognome/Last Name/g' "$file"
    sed -i 's/Titolo/Title/g' "$file"
    sed -i 's/Inizio/Start/g' "$file"
    sed -i 's/Fine/End/g' "$file"
    sed -i 's/Elimina/Delete/g' "$file"
    sed -i 's/Modifica/Edit/g' "$file"
    sed -i 's/Nuovo/New/g' "$file"
    sed -i 's/Evento/Event/g' "$file"
    sed -i 's/Programmato/Scheduled/g' "$file"
    sed -i 's/Caricamento/Loading/g' "$file"
    sed -i 's/Inserisci/Enter/g' "$file"
    sed -i 's/Seleziona/Select/g' "$file"
    sed -i 's/Data/Date/g' "$file"
    sed -i 's/Ora/Time/g' "$file"
    sed -i 's/Obbligatorio/Required/g' "$file"
    sed -i 's/Valida/Validate/g' "$file"
    sed -i 's/Successiva/Next/g' "$file"
    sed -i 's/Precedente/Previous/g' "$file"
    sed -i 's/Mese/Month/g' "$file"
    sed -i 's/Successivo/Next/g' "$file"
    sed -i 's/Tutto il giorno/All day/g' "$file"
    sed -i 's/Nessun/No/g' "$file"
    sed -i 's/In corso/In progress/g' "$file"
    sed -i 's/Descrittivo/Descriptive/g' "$file"
    sed -i 's/Sicuro/Sure/g' "$file"
    sed -i 's/Voler/Want/g' "$file"
    sed -i 's/Eliminare/Delete/g' "$file"
    sed -i 's/Questo/This/g' "$file"
    sed -i 's/Con successo/Successfully/g' "$file"
    sed -i 's/Errore/Error/g' "$file"
    sed -i 's/Durante/During/g' "$file"
    sed -i 's/Creazione/Creation/g' "$file"
    sed -i 's/Salvataggio/Saving/g' "$file"
    sed -i 's/Modifiche/Changes/g' "$file"
    sed -i 's/Campo/Field/g' "$file"
    sed -i 's/√à/Is/g' "$file"
    sed -i 's/Una/A/g' "$file"
    sed -i 's/Di fine/End/g' "$file"
    sed -i 's/Di inizio/Start/g' "$file"
    sed -i 's/Deve essere/Must be/g' "$file"
    
    # Termini specifici del sistema
    sed -i 's/Gestione/Management/g' "$file"
    sed -i 's/Sistema/System/g' "$file"
    sed -i 's/Utente/User/g' "$file"
    sed -i 's/Amministratore/Administrator/g' "$file"
    sed -i 's/Permessi/Permissions/g' "$file"
    sed -i 's/Ruoli/Roles/g' "$file"
    sed -i 's/Profilo/Profile/g' "$file"
    sed -i 's/Impostazioni/Settings/g' "$file"
    sed -i 's/Configurazione/Configuration/g' "$file"
    sed -i 's/Notifiche/Notifications/g' "$file"
    sed -i 's/Email/Email/g' "$file"
    sed -i 's/Messaggi/Messages/g' "$file"
    sed -i 's/Contatti/Contacts/g' "$file"
    sed -i 's/Calendario/Calendar/g' "$file"
    sed -i 's/Appuntamenti/Appointments/g' "$file"
    sed -i 's/Pazienti/Patients/g' "$file"
    sed -i 's/Dottori/Doctors/g' "$file"
    sed -i 's/Studi/Studios/g' "$file"
    sed -i 's/Disponibilit√†/Availability/g' "$file"
    sed -i 's/Prenotazioni/Bookings/g' "$file"
    sed -i 's/Report/Reports/g' "$file"
    sed -i 's/Statistiche/Statistics/g' "$file"
    sed -i 's/Dashboard/Dashboard/g' "$file"
    sed -i 's/Pannello/Panel/g' "$file"
    sed -i 's/Navigazione/Navigation/g' "$file"
    sed -i 's/Menu/Menu/g' "$file"
    sed -i 's/Pagina/Page/g' "$file"
    sed -i 's/Sezione/Section/g' "$file"
    sed -i 's/Blocco/Block/g' "$file"
    sed -i 's/Contenuto/Content/g' "$file"
    sed -i 's/Modulo/Module/g' "$file"
    sed -i 's/Funzionalit√†/Features/g' "$file"
    sed -i 's/Azioni/Actions/g' "$file"
    sed -i 's/Pulsanti/Buttons/g' "$file"
    sed -i 's/Form/Form/g' "$file"
    sed -i 's/Tabella/Table/g' "$file"
    sed -i 's/Colonne/Columns/g' "$file"
    sed -i 's/Righe/Rows/g' "$file"
    sed -i 's/Filtri/Filters/g' "$file"
    sed -i 's/Ricerca/Search/g' "$file"
    sed -i 's/Ordina/Sort/g' "$file"
    sed -i 's/Esporta/Export/g' "$file"
    sed -i 's/Importa/Import/g' "$file"
    sed -i 's/Scarica/Download/g' "$file"
    sed -i 's/Carica/Upload/g' "$file"
    sed -i 's/Visualizza/View/g' "$file"
    sed -i 's/Modifica/Edit/g' "$file"
    sed -i 's/Crea/Create/g' "$file"
    sed -i 's/Salva/Save/g' "$file"
    sed -i 's/Annulla/Cancel/g' "$file"
    sed -i 's/Conferma/Confirm/g' "$file"
    sed -i 's/Chiudi/Close/g' "$file"
    sed -i 's/Apri/Open/g' "$file"
    sed -i 's/Attiva/Activate/g' "$file"
    sed -i 's/Disattiva/Deactivate/g' "$file"
    sed -i 's/Abilita/Enable/g' "$file"
    sed -i 's/Disabilita/Disable/g' "$file"
    sed -i 's/Abilitato/Enabled/g' "$file"
    sed -i 's/Disabilitato/Disabled/g' "$file"
    sed -i 's/Attivo/Active/g' "$file"
    sed -i 's/Inattivo/Inactive/g' "$file"
    sed -i 's/Completato/Completed/g' "$file"
    sed -i 's/In corso/In progress/g' "$file"
    sed -i 's/Pendente/Pending/g' "$file"
    sed -i 's/Approvato/Approved/g' "$file"
    sed -i 's/Rifiutato/Rejected/g' "$file"
    sed -i 's/Accettato/Accepted/g' "$file"
    sed -i 's/Valido/Valid/g' "$file"
    sed -i 's/Non valido/Invalid/g' "$file"
    sed -i 's/Corretto/Correct/g' "$file"
    sed -i 's/Errato/Wrong/g' "$file"
    sed -i 's/Successo/Success/g' "$file"
    sed -i 's/Fallito/Failed/g' "$file"
    sed -i 's/Completato/Completed/g' "$file"
    sed -i 's/Incompleto/Incomplete/g' "$file"
    sed -i 's/Vuoto/Empty/g' "$file"
    sed -i 's/Pieno/Full/g' "$file"
    sed -i 's/Libero/Free/g' "$file"
    sed -i 's/Occupato/Busy/g' "$file"
    sed -i 's/Disponibile/Available/g' "$file"
    sed -i 's/Non disponibile/Unavailable/g' "$file"
    sed -i 's/Online/Online/g' "$file"
    sed -i 's/Offline/Offline/g' "$file"
    sed -i 's/Connesso/Connected/g' "$file"
    sed -i 's/Disconnesso/Disconnected/g' "$file"
    sed -i 's/Pubblico/Public/g' "$file"
    sed -i 's/Privato/Private/g' "$file"
    sed -i 's/Visibile/Visible/g' "$file"
    sed -i 's/Nascosto/Hidden/g' "$file"
    sed -i 's/Visibile/Visible/g' "$file"
    sed -i 's/Invisibile/Invisible/g' "$file"
    sed -i 's/Abilitato/Enabled/g' "$file"
    sed -i 's/Disabilitato/Disabled/g' "$file"
    sed -i 's/Consentito/Allowed/g' "$file"
    sed -i 's/Non consentito/Not allowed/g' "$file"
    sed -i 's/Permesso/Permission/g' "$file"
    sed -i 's/Divieto/Prohibition/g' "$file"
    sed -i 's/Autorizzato/Authorized/g' "$file"
    sed -i 's/Non autorizzato/Unauthorized/g' "$file"
    sed -i 's/Autenticato/Authenticated/g' "$file"
    sed -i 's/Non autenticato/Unauthenticated/g' "$file"
    sed -i 's/Registrato/Registered/g' "$file"
    sed -i 's/Non registrato/Unregistered/g' "$file"
    sed -i 's/Verificato/Verified/g' "$file"
    sed -i 's/Non verificato/Unverified/g' "$file"
    sed -i 's/Confermato/Confirmed/g' "$file"
    sed -i 's/Non confermato/Unconfirmed/g' "$file"
    sed -i 's/Approvato/Approved/g' "$file"
    sed -i 's/Non approvato/Unapproved/g' "$file"
    sed -i 's/Accettato/Accepted/g' "$file"
    sed -i 's/Rifiutato/Rejected/g' "$file"
    sed -i 's/Valido/Valid/g' "$file"
    sed -i 's/Non valido/Invalid/g' "$file"
    sed -i 's/Corretto/Correct/g' "$file"
    sed -i 's/Errato/Wrong/g' "$file"
    sed -i 's/Successo/Success/g' "$file"
    sed -i 's/Fallito/Failed/g' "$file"
    sed -i 's/Completato/Completed/g' "$file"
    sed -i 's/Incompleto/Incomplete/g' "$file"
    sed -i 's/Vuoto/Empty/g' "$file"
    sed -i 's/Pieno/Full/g' "$file"
    sed -i 's/Libero/Free/g' "$file"
    sed -i 's/Occupato/Busy/g' "$file"
    sed -i 's/Disponibile/Available/g' "$file"
    sed -i 's/Non disponibile/Unavailable/g' "$file"
    sed -i 's/Online/Online/g' "$file"
    sed -i 's/Offline/Offline/g' "$file"
    sed -i 's/Connesso/Connected/g' "$file"
    sed -i 's/Disconnesso/Disconnected/g' "$file"
    sed -i 's/Pubblico/Public/g' "$file"
    sed -i 's/Privato/Private/g' "$file"
    sed -i 's/Visibile/Visible/g' "$file"
    sed -i 's/Nascosto/Hidden/g' "$file"
    sed -i 's/Visibile/Visible/g' "$file"
    sed -i 's/Invisibile/Invisible/g' "$file"
    
    ((files_fixed++))
    echo "‚úÖ Corretto: $file"
}

# Trova tutti i file di traduzione inglesi
echo "üîç Cercando file di traduzione inglesi..."
english_files=$(find laravel/Modules -path "*/lang/en/*.php" -type f)

if [ -z "$english_files" ]; then
    echo "‚ùå Nessun file di traduzione inglese trovato"
    exit 1
fi

echo "üìÅ Trovati $(echo "$english_files" | wc -l) file di traduzione inglesi"
echo ""

# Processa ogni file
for file in $english_files; do
    # Controlla se il file contiene testo italiano
    if grep -q "Gennaio\|Febbraio\|Marzo\|Aprile\|Maggio\|Giugno\|Luglio\|Agosto\|Settembre\|Ottobre\|Novembre\|Dicembre\|Luned√¨\|Marted√¨\|Mercoled√¨\|Gioved√¨\|Venerd√¨\|Sabato\|Domenica\|Configurazione\|Orari\|Mattina\|Pomeriggio\|Aperto\|Chiuso\|Nome\|Cognome\|Titolo\|Inizio\|Fine\|Elimina\|Modifica\|Nuovo\|Evento\|Programmato\|Caricamento\|Inserisci\|Seleziona\|Data\|Ora\|Obbligatorio\|Valida\|Successiva\|Precedente\|Mese\|Successivo\|Tutto il giorno\|Nessun\|In corso\|Descrittivo\|Sicuro\|Voler\|Eliminare\|Questo\|Con successo\|Errore\|Durante\|Creazione\|Salvataggio\|Modifiche\|Campo\|√à\|Una\|Di fine\|Di inizio\|Deve essere" "$file"; then
        fix_file "$file"
    fi
done

echo ""
echo "üéâ Correzione completata!"
echo "üìä File corretti: $files_fixed"
echo ""
echo "üí° Suggerimenti:"
echo "   - Verifica manualmente alcuni file per assicurarti della qualit√†"
echo "   - Controlla che le traduzioni siano appropriate per il contesto"
echo "   - Aggiorna la documentazione se necessario" 