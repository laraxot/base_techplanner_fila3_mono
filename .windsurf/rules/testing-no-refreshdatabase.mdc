---
summary: Regola locale test senza RefreshDatabase
---

# Testing â€“ No RefreshDatabase (Laraxot)

- MAI usare `RefreshDatabase` in qualunque test.
- Preferire unit test puri e setup mirato (filesystem/json) senza DB.
- Se serve DB: creare esplicitamente il file SQLite di test e migrare tabelle minime richieste.

## Linee guida pratiche
- Pulire i file JSON dei test prima/dopo (setUp/tearDown).
- Usare percorsi assoluti e isolati per i file temporanei.
- Evitare side-effect globali (cache, auth state) nei test unitari.

## Esempio (SQLite on-demand)
```php
// setUp():
$path = base_path('database/testing.sqlite');
if (! file_exists($path)) {
    touch($path);
}
config(['database.connections.testing' => [
    'driver' => 'sqlite',
    'database' => $path,
    'prefix' => '',
]]);
// eseguire solo le migrazioni necessarie
```

## Applicazione al modulo Tenant
- I test di `SushiToJson` non devono eseguire migrazioni.
- Gestire il JSON in `config/{tenant}/database/content/*.json` con cleanup in test.
